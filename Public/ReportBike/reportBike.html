<?php
session_start();
?>

<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title> Bike Reporter - Report Stolen Bike </title>
        <!-- Links the Stylesheet -->
        <link rel="stylesheet" type="text/css" href="..\..\Stylesheet\stylesheet.css">

        <!-- Loads in jQuery 3.2.1 and indexeddb -->
        <script src="../../js/jquery-3.2.1.js"></script>
    </head>
    <body onload="clickButton()">

        <header class="reportBike">
            <h1> Bike Reporter </h1>
            <h2> Report Stolen Bike </h2>

            <!-- A number of items in a list that act as hyperlinks to other pages on the site.
            These links make up the navigation bar on the site, and are re-arranged with CSS code
            to make the layout look nicer. -->
            <nav>
                <ul>
                    <li> <a href="../Home/home.html">Home</a> </li>
                    <li> <a href="../RegisterBike/registerBike.html">Register Bike</a> </li>
                    <li> <a href="../ReportBike/reportBike.html">Report Stolen Bike</a> </li>
                    <li> <a href="../StatusCheck/statusCheck.html">Status Check</a> </li>
                </ul>
            </nav>
        </header>

        <section class="report">
            <p> Select a registered bike to report it as stolen: </p>


            <div class="report">
                <form class="report" action="reportBike.php" method="POST">
                    <input type="submit" name="refresh" value="Generate Table" class="report" id="refreshButton" onclick="clickButton()">
                </form>
            </div>



                <!-- <?php
                $owner = $_SESSION['currentUser'];

                // Change the following as applicable to suit the server it is on
                // The values here are used in every mysqli connection in the file
                $serverName = 'localhost';
                $dbUsername = 's1703829_user';
                $dbPassword = 'password100';
                $dbName = 's1703829_TeamOJ';

                // Creates a SQL db connection with the above credentials
                $mysqli = new mysqli($serverName, $dbUsername, $dbPassword, $dbName);

                // Checks for errors in the SQL connection
                if ($mysqli->connect_errno) {
                    echo "Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
                    session_destroy();
                    exit;
                } else {

                }

                $query = "SELECT * FROM `Bikes` WHERE Owner = '$owner'";

                $result = mysqli_query($mysqli, $query);

                echo "<table class="report" id="bikeTable">
                    <tr>
                        <th>Bike Make</th>
                        <th>Bike Model</th>
                        <th>Serial No.</th>
                    </tr>";

                while($row = mysqli_fetch_array($result)) {
                    echo "<tr><td>".$row['Make']."</td><td>".$row['Model']."</td><td>".$row['Serial No']."</td></tr>";
                }
                echo "</table><br>";

                $mysqli->close();
                ?> -->


            <!-- On clicking the following button, a funciton is run to select the chosen serial number from the table
            and compare it with the database to find the right bike. After finding the right bike in the database, the
            entry is updated to say that the bike has been reported as stolen. -->
            <input type="submit" name="reportStolen" value="Report Stolen" class="report" onclick="serialNoSelect()">
        </section>

        <form class='report' action='submitBikeReport.php' method='POST'>
            <label for='serialNumber'>Serial Number:</label><br>
            <input type='text' name='serialNumber'><br><br>

            <input type='submit' name='submitSerialNumber' value='Report Stolen'>
        </form>

        <!-- This loads in the javascript from 'reportBike.js' -->
        <script src="./reportBike.js"></script>

    </body>
</html>
